<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Schematic</title>
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons (React Version) - Using a specific stable version for UMD compatibility -->
    <script src="https://unpkg.com/lucide-react@0.294.0/dist/umd/lucide-react.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Access Lucide from the window object to ensure it captures the global variable correctly
        // Version 0.294.0 exports to window.lucide
        const { Shield, Zap, Lock, Heart, AlertTriangle, ArrowRight, XCircle, Activity, Minimize2, Maximize2 } = window.lucide;
        const { useState, useEffect } = React;

        const NeuralSchematic = () => {
          const [activeNode, setActiveNode] = useState('self');
          const [zoom, setZoom] = useState(1);

          // --- CONFIGURATION ---
          const nodes = {
            manager: {
              id: 'manager', label: 'MEGA-MANAGER', role: 'Architect',
              x: 400, y: 150, color: '#22d3ee', icon: Shield,
              subNodes: ['Rigid Scheduling', 'Perfectionism', 'Risk Analysis', 'Future Forecasting']
            },
            firefighter: {
              id: 'firefighter', label: 'MEGA-FIREFIGHTER', role: 'Reactor',
              x: 650, y: 350, color: '#f87171', icon: Zap,
              subNodes: ['Dopamine Flood', 'Dissociation', 'Impulse Buy', 'Rage Spike']
            },
            exile: {
              id: 'exile', label: 'MEGA-EXILE', role: 'The Vault',
              x: 400, y: 550, color: '#c084fc', icon: Lock,
              subNodes: ['Childhood Wound', 'Abandonment Fear', 'Shame Core', 'Unmet Needs']
            },
            critic: {
              id: 'critic', label: 'MEGA-CRITIC', role: 'Linter',
              x: 150, y: 350, color: '#facc15', icon: AlertTriangle,
              subNodes: ['Social Scanning', 'Comparison', 'Error Highlighting', 'Self-Judgment']
            },
            self: {
              id: 'self', label: 'MEGA-SELF', role: 'Kernel',
              x: 400, y: 350, color: '#34d399', icon: Heart,
              subNodes: ['Compassion', 'Curiosity', 'Clarity', 'Connectedness']
            }
          };

          // Define relationships for the lines
          const edges = [
            { from: 'manager', to: 'exile', type: 'suppress', label: 'BLOCKS ACCESS', color: '#60a5fa' },
            { from: 'firefighter', to: 'exile', type: 'numb', label: 'NUMBS PAIN', color: '#f87171' },
            { from: 'critic', to: 'manager', type: 'alert', label: 'TRIGGERS PLANNING', color: '#facc15' },
            { from: 'self', to: 'manager', type: 'lead', label: 'UNBLENDS', color: '#34d399' },
            { from: 'self', to: 'exile', type: 'heal', label: 'WITNESSES', color: '#34d399' },
          ];

          // Helper to calculate SVG path for curved lines
          const getPath = (start, end) => {
            // Add some curve based on relative positions
            const dx = end.x - start.x;
            const dy = end.y - start.y;
            const midX = start.x + dx / 2;
            const midY = start.y + dy / 2;
            
            // Offset control point for curve
            const offset = 50;
            // Simple logic to curve away from center if line is long
            const controlX = midX + (Math.abs(dx) < 50 ? offset : 0);
            const controlY = midY + (Math.abs(dy) < 50 ? offset : 0);

            return `M ${start.x} ${start.y} Q ${controlX} ${controlY} ${end.x} ${end.y}`;
          };

          return (
            <div className="flex flex-col h-screen bg-slate-950 text-white font-mono overflow-hidden">
              
              {/* HUD Header */}
              <div className="absolute top-0 left-0 right-0 p-6 z-10 flex justify-between items-start pointer-events-none">
                <div>
                  <h1 className="text-2xl font-bold text-emerald-400 tracking-wider">NEURAL SCHEMATIC</h1>
                  <div className="flex items-center gap-2 text-xs text-slate-500 mt-1">
                    <Activity className="w-3 h-3 animate-pulse text-emerald-500" />
                    <span>TOPOLOGICAL MAPPING // LIVE</span>
                  </div>
                </div>
                <div className="pointer-events-auto flex gap-2">
                   <button onClick={() => setZoom(z => Math.max(0.5, z - 0.1))} className="p-2 bg-slate-900 border border-slate-700 hover:border-emerald-500 rounded"><Minimize2 className="w-4 h-4" /></button>
                   <button onClick={() => setZoom(z => Math.min(1.5, z + 0.1))} className="p-2 bg-slate-900 border border-slate-700 hover:border-emerald-500 rounded"><Maximize2 className="w-4 h-4" /></button>
                </div>
              </div>

              {/* Main Canvas */}
              <div className="flex-1 overflow-hidden relative flex items-center justify-center bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-slate-900/50 to-slate-950">
                
                {/* Grid Background */}
                <div className="absolute inset-0 opacity-10" 
                     style={{ 
                       backgroundImage: 'linear-gradient(#334155 1px, transparent 1px), linear-gradient(90deg, #334155 1px, transparent 1px)', 
                       backgroundSize: '20px 20px' 
                     }}>
                </div>

                <div 
                  className="relative transition-transform duration-500 ease-out"
                  style={{ width: '800px', height: '700px', transform: `scale(${zoom})` }}
                >
                  <svg className="absolute inset-0 w-full h-full overflow-visible pointer-events-none">
                    <defs>
                      <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="28" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#475569" />
                      </marker>
                    </defs>

                    {/* Render Connections */}
                    {edges.map((edge, i) => {
                      const start = nodes[edge.from];
                      const end = nodes[edge.to];
                      const isSelected = activeNode === edge.from || activeNode === edge.to;
                      
                      return (
                        <g key={i} className={`transition-opacity duration-300 ${activeNode && !isSelected ? 'opacity-20' : 'opacity-100'}`}>
                          {/* The Line */}
                          <path 
                            d={getPath(start, end)}
                            fill="none"
                            stroke={edge.color}
                            strokeWidth="2"
                            strokeDasharray="5,5"
                            className="animate-[dash_20s_linear_infinite]"
                          />
                          
                          {/* The Label */}
                          <g transform={`translate(${(start.x + end.x)/2}, ${(start.y + end.y)/2})`}>
                            <rect x="-60" y="-10" width="120" height="20" fill="#0f172a" stroke={edge.color} strokeWidth="1" rx="4" />
                            <text x="0" y="4" textAnchor="middle" fill={edge.color} fontSize="9" fontWeight="bold">
                              {edge.label}
                            </text>
                          </g>

                          {/* Animated Particle Packet */}
                          <circle r="4" fill="white">
                            <animateMotion dur="3s" repeatCount="indefinite" path={getPath(start, end)} />
                          </circle>
                        </g>
                      );
                    })}
                  </svg>

                  {/* Render Nodes */}
                  {Object.values(nodes).map((node) => {
                    const isActive = activeNode === node.id;
                    const Icon = node.icon;
                    
                    return (
                      <div 
                        key={node.id}
                        className={`absolute transform -translate-x-1/2 -translate-y-1/2 cursor-pointer transition-all duration-300 z-10`}
                        style={{ left: node.x, top: node.y }}
                        onClick={() => setActiveNode(node.id)}
                      >
                        {/* Orbital Rings (for active node) */}
                        {isActive && (
                          <>
                            <div className="absolute inset-0 -m-8 border border-dashed border-slate-600 rounded-full animate-[spin_10s_linear_infinite]"></div>
                            <div className="absolute inset-0 -m-4 border border-slate-700 rounded-full animate-[spin_8s_linear_infinite_reverse]"></div>
                          </>
                        )}

                        {/* Main Node Body */}
                        <div 
                          className={`
                            relative flex flex-col items-center justify-center w-20 h-20 rounded-full border-2 bg-slate-900 shadow-2xl
                            ${isActive ? 'border-opacity-100 scale-110' : 'border-opacity-30 scale-100 hover:border-opacity-70'}
                          `}
                          style={{ borderColor: node.color, boxShadow: isActive ? `0 0 30px ${node.color}40` : 'none' }}
                        >
                          <Icon 
                            className={`w-8 h-8 transition-colors duration-300`} 
                            style={{ color: node.color }}
                          />
                          
                          {/* Mini Type Label */}
                          <div 
                            className="absolute -bottom-3 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider bg-slate-950 border"
                            style={{ borderColor: node.color, color: node.color }}
                          >
                            {node.role}
                          </div>
                        </div>

                        {/* Sub-Node List (Thoughts) - Expands when active */}
                        <div className={`
                          absolute left-24 top-0 -translate-y-1/2 w-48 space-y-2 pointer-events-none transition-all duration-300
                          ${isActive ? 'opacity-100 translate-x-0' : 'opacity-0 -translate-x-4'}
                        `}>
                          <div className="text-xs font-bold text-slate-500 mb-1 uppercase tracking-widest pl-1">Active Subroutines</div>
                          {node.subNodes.map((sub, i) => (
                            <div 
                              key={i} 
                              className="flex items-center gap-2 bg-slate-900/90 border border-slate-800 p-2 rounded shadow-lg backdrop-blur-sm"
                              style={{ transitionDelay: `${i * 50}ms` }}
                            >
                              <div className="w-1.5 h-1.5 rounded-full" style={{ backgroundColor: node.color }}></div>
                              <span className="text-xs text-slate-300">{sub}</span>
                            </div>
                          ))}
                        </div>

                      </div>
                    );
                  })}
                </div>
              </div>

              {/* Footer Info */}
              <div className="p-4 border-t border-slate-800 bg-slate-950 flex justify-between items-center text-xs text-slate-500">
                <div>
                  SELECTED NODE: <span className="text-white font-bold ml-2">{nodes[activeNode].label}</span>
                </div>
                <div className="flex gap-4">
                  <div className="flex items-center gap-2">
                    <span className="w-2 h-2 rounded-full bg-blue-400"></span> Suppress
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="w-2 h-2 rounded-full bg-red-400"></span> Numb
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="w-2 h-2 rounded-full bg-yellow-400"></span> Alert
                  </div>
                </div>
              </div>

              <style>{`
                @keyframes dash {
                  to {
                    stroke-dashoffset: -100;
                  }
                }
              `}</style>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<NeuralSchematic />);
    </script>
</body>
</html>
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<NeuralSchematic />);
    </script>
</body>

</html>
